<module>
    <immask>
        wrappername = generic.py
        wrapperloop = ccdnum
        modnamepat=${modnamepat_ccdnumband}
        <file>
            <red_bleedmasked>
                filetype = red
		#filename = ${input_pat}_bleedmasked.fits
		filename = D${expnum:8}_${band}_c${ccdnum:2}_r${reqnum_input}p${attnum_input:2}_bleedmasked.fits
                #filepat = ccdnum_band
                #flabel = bleedmasked    
                #fsuffix = fits
                dirpat = se
                ops_enddir = red
                rundir = red
            </red_bleedmasked>
   	    <red_bkg>
		filename = D${expnum:8}_${band}_c${ccdnum:2}_r${reqnum_input}p${attnum_input:2}_bkg.fits
                filetype = red_bkg
                #filepat = ccdnum_band
                #flabel = bkg
                #fsuffix = fits
                dirpat = se
                ops_enddir = bkg
                rundir = bkg
            </red_bkg>
            <red_immasked>
                filetype = red
                filepat = ccdnum_band
                flabel = immasked
                fsuffix = fits
                dirpat = se
                ops_enddir = red
                rundir = red
            </red_immasked>
	    <red_streaks>
                filetype = red_streaks
		filename = D${expnum:8}_${band}_c${ccdnum:2}_r${reqnum}p${attnum:2}_streaks.fits
                filepat = ccdnum_band
                dirpat = se
                ops_enddir = aux
                optional = true
                rundir = red
            </red_streaks>
        </file>

        <exec_1>
            execname = immask
     	    cmd_hyphen = alldouble
            used = file.red_bleedmasked,file.red_bkg
            was_generated_by = file.red_immasked,file.red_streaks
            ancestry = file.red_bleedmasked:file.red_immasked, file.red_bkg:file.red_immasked, file.red_bleedmasked:file.red_streaks
            <cmdline>
                # Command line arguments suggested by Alex June 1, 2015
                # --minSigma 7.0 --max_angle 360 --max_width 230 --nsig_detect 18 --nsig_mask 10 --nsig_merge 10
                _01_red_immask_type = all
                _02_red_bleedmasked = ${file.red_bleedmasked.fullname}
                _03_red_immasked = ${file.red_immasked.fullname}
                streaksfile = ${file.red_streaks.fullname}
                write_streaks = _flag
                max_width   = 230
                max_angle   = 360
                nsig_mask   = 10
                nsig_merge  = 10
                nsig_detect = 18
    	    	minSigma    = 7.0
                bkgfile = ${file.red_bkg.fullname}
            </cmdline>
        </exec_1>
    </immask>
</module>
